= test creation tutorial =

== Concept ==
We'll try to create a simple test containing three test items. First one will be the start item where user can enter his or her name and start the test. The name of the user will then be used later in other items. The second item will contain questions and possible answers that user can take. We'll define simple question bank in R and we'll populate this item with every question from the bank one by one. To simplify this demo test we're going to use only yes or no as a possible answer. Finally when we ran out of questions the total score will be shown in final item.

== step 1: create item's presentation ==
=== `demo_start` ===
  * to create a new item click *'new'* button in the form on the left side of *'item'* tab
  * enter *'demo_start'* as an item name in the form
  * go to the *'Presentation and Properties'* tab, switch editor to *'Source'* mode and fill it with following content:

{{{
<p>
	This is a demo test.</p>
<p>
	Enter your name and click &#39;Start&#39; button.</p>
<p>
	name:&nbsp;<input name="field_name" type="text" /><input name="btn_start" type="button" value="Start" /></p>
}}}
*All of this can also be done in graphical mode but for demonstration purposes it will be easier just to copy the whole source in 'Source' mode.*

  * save the item by clicking *'save'* button

Now switch back to *'graphical'* mode ( click on the *source* button again ).
We have a button here named *'btn_start'*. We can later assign R code to execute when we click on it while running test.
We also have here a text box named *'field_name'* which will be filled by user running test and we can use it's value later in HTML presentation or in R calculations.

This HTML should look like this:

http://dev.myiqtest.org/concerto2/wiki_images/demo_start.png


=== `demo_item` ===
  * to create a new item click *'new'* button in the form on the left side of *'item'* tab
  * enter *'demo_item'* as an item name in the form
  * go to the *'Presentation and Properties'* tab, switch editor to *'Source'* mode and fill it with following content:

{{{
<p>
	{{field_name}} please answer the question:</p>
<p style="text-align: center; ">
	Question #{{current_question_no}}:</p>
<p style="text-align: center; ">
	{{question}}</p>
<p style="text-align: center; ">
	<input checked="checked" name="field_answer" type="radio" value="0" />no<input name="field_answer" type="radio" value="1" />yes</p>
<p style="text-align: center; ">
	<input name="btn_next" type="button" value="next" /><input name="btn_restart" type="button" value="restart" /></p>

}}}
*All of this can also be done in graphical mode but for demonstration purposes it will be easier just to copy the whole source in 'Source' mode.*

  * save the item by clicking *'save'* button

Now switch back to *'graphical'* mode.
See those double brackets with text inside them? You can insert session variables to your HTML presentation this way. This way *{{question}}* will be replaced by value of session variable named *question*.
On this item we have two buttons used to execute R code and two radio buttons from the same group ( they have the same name: *field_answer* ). Those radio buttons will be used by user running the test to give you the answer. Answer can be *yes* ( radio button value *0* ) or *no* ( radio button value *1* ).

This HTML should look like this:

http://dev.myiqtest.org/concerto2/wiki_images/demo_item.png

=== `demo_feedback` ===
  * to create a new item click *'new'* button in the form on the left side of *'item'* tab
  * enter *'demo_feedback'* as an item name in the form
  * go to the *'Presentation and Properties'* tab, switch editor to *'Source'* mode and fill it with following content:

{{{
{{field_name}}, your total score is {{total_score}}.
}}}
*All of this can also be done in graphical mode but for demonstration purposes it will be easier just to copy the whole source in 'Source' mode.*

  * save the item by clicking *'save'* button

Only thing worth mentioning here are double brackets used for session variables insertion.

This HTML should look like this:

http://dev.myiqtest.org/concerto2/wiki_images/demo_feedback.png

== step 2: assign R code to item's buttons ==
=== `demo_start` ===
  * edit *'demo_start'* item
  * go to the *'R Interaction'* tab where you can assign R code to the item's buttons

We have only one button in this item: *'btn_start'*. Paste this as a *R code to execute*:

{{{
## questions array
x <- array(dim=3)
x[1]<-"Is 3-2=6?"
x[2]<-"Is 2+3=6?"
x[3]<-"Is 3*2=6?"

## correct answers array
y <- array(dim=3)
y[1]<-0
y[2]<-0
y[3]<-1

## set index of first question to show up
current_question_no <- 1
## initialize total score value
total_score <- 0

## set R variables as session variables for use in presentation HTML and set next item to show up
set.var("current_question_no",current_question_no)
set.var("question",x[current_question_no])
set.next.item("demo_item")
}}}

  * save the item by clicking *'save'* button

=== `demo_item` ===
* edit *'demo_item'* item
  * go to the *'R Interaction'* tab where you can assign R code to the item's buttons

We have two buttons here. 
  * *'btn_next'*

Paste this *'R code to execute'*:

{{{
## if answer correct then increment total score value
if(y[current_question_no] == as.numeric(field_answer)) total_score <- total_score + 1
  
## if this isn't the last question then change current question to next one and if it is then show feedback page with total score value
if(current_question_no < 3) {
  current_question_no <- current_question_no + 1
  question <- x[current_question_no]
  set.var("current_question_no",current_question_no)
  set.var("question",question)
} else {
  set.var("total_score",total_score)
  set.next.item("demo_feedback") 	
}
}}}

  * *'btn_restart'*

Paste this *'R code to execute'*:

{{{
## sets item to show up next
set.next.item("demo_start")
}}}

  * save the item by clicking *'save'* button

= and that's all =
You can now run the test you created.

You can either run it in *debug* mode to see what's going on behind the scene. You do it by clicking *'debug'* button next to the item ( *'demo_start'* in this case ).

Or you can run it in normal mode by passing item's *hash* value as an URL argument.

e.g. /index.php?*hash=enter_item_hash_here*

= see live demo here =
[http://dev.myiqtest.org/concerto2/index.php?hash=ab0334826613005bfcf26d52392b7ced click for live demo]